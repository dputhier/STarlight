--- 
title: "REPORT_TITLE"
subtitle: "REPORT_SUBTITLE"
author: "REPORT_AUT"
date: "REPORT_DATE"
site: bookdown::bookdown_site
output:
  bookdown::gitbook:
    css: style.css
    number_sections: false
    config:
      toc_depth: 1
      toc:
        collapse: section
    sharing:
        github: no
        facebook: no
        twitter: no
        all: no
documentclass: book
params:
  fig_path: "all_"
---


<!-- UPPERCASE variable are text to be replaced. -->
<!-- There are several global variables obtained from st_report() function. -->


```{r start, include=FALSE, echo=FALSE, eval=TRUE}
STarlight::set_verb_level(0)
library(knitr)
options(width=400)

knitr::opts_chunk$set(
  fig.path="FIG_PATH",
  fig.align = "center", 
  size = "tiny", 
  comment = "",
  fig.dpi=300,
  out.width="100%"
)
library(DT)
```

# {-}

```{r panel_setup_final, include = FALSE}
xaringanExtra::use_panelset()
xaringanExtra::style_panelset(font_family = "inherit")
xaringanExtra::style_panelset_tabs(foreground = "honeydew", background = "seagreen")
```

```{r, section_gen_info_1, eval="exp_info" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("# Global ") 
``` 

```{r, section_gen_info_1, eval="exp_info" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("## Experiment {.panelset}") 
``` 


```{r, section_gen_info_2, eval="exp_info" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("### General information ") 
``` 

```{r, section_gen_info_3, eval="exp_info" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("This table display metadata about the report (e.g., title, subtitle, author, and date).") 
``` 

```{r parameters, echo=FALSE, eval="exp_info" %in% section}

t1 <- rbind(c("Title: ", "REPORT_TITLE"),
            c("Subtitle: ", "REPORT_SUBTITLE"),
            c("Author", "REPORT_AUT"),
            c("Date", "REPORT_DATE")
            )

knitr::kable(t1) %>% kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::kable_styling() %>%
  kableExtra::scroll_box(width = "100%", box_css = "border: 0px;")
```

```{r, section_gen_info_4, eval="exp_info" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("### Experimenters") 
``` 


```{r, section_gen_info_5, eval="exp_info" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("This table display metadata about the experimenters.") 
``` 

```{r experimenters, echo=FALSE, eval="exp_info" %in% section,}

knitr::kable(experimenters) %>% 
  kableExtra::row_spec(1, bold = TRUE) %>% 
  kableExtra::kable_styling(full_width = FALSE, position = "left") %>%
  kableExtra::kable_styling() %>%
  kableExtra::scroll_box(width = "100%", box_css = "border: 0px;")
```

```{r, section_gen_info_6, eval="exp_info" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("### Sample information") 
``` 


```{r sample, echo=FALSE, eval="exp_info" %in% section}

knitr::kable(sample_info) %>% 
  kableExtra::row_spec(1, bold = TRUE) %>% 
  kableExtra::kable_styling(full_width = FALSE, position = "left") %>%
  kableExtra::kable_styling() %>%
  kableExtra::scroll_box(width = "100%", box_css = "border: 0px;")
```

```{r, section_gen_info_5, eval="exp_info" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("### Workflow parameters.") 
``` 
  
```{r, section_gen_info_6, eval="exp_info" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("This table display informations about the worflow parameters.") 
``` 

```{r parameters, echo=FALSE, eval="exp_info" %in% section}

t1 <- rbind(c("Nb of modules: ", hc_tree_params[['class_nb']]),
            c("Image height: ", image_height)
            )

knitr::kable(t1) %>% kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::kable_styling() %>%
  kableExtra::scroll_box(width = "100%", box_css = "border: 0px;")
```

```{r, section_exp_count_1, eval="exp_count" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("## Counts {.panelset}") 
``` 

```{r, section_exp_count_2, eval="exp_count" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("This section provide an overview of total counts across samples.") 
```

```{r, section_exp_count_3, eval="exp_count" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("### Total counts (linear)") 
``` 

```{r distributions_raw, echo=FALSE, eval="exp_count" %in% section, fig.height=4.5}
STarlight::cmp_counts_st(st_grid_list, features=c("count_sum"))
```

```{r, section_exp_count_4, eval="exp_count" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("### log10(total counts)") 
``` 

```{r distributions_log, echo=FALSE, eval="exp_count" %in% section, fig.height=4.5}
STarlight::cmp_counts_st(st_grid_list, features=c("count_sum"), 
                         transform = "log10")
```


```{r, section_exp_count_dist_1, eval="exp_count_dist" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("## Count distributions {.panelset}") 
``` 

```{r, section_exp_count_dist_2, eval="exp_count_dist" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("This section provides information about feature count distribution across samples.") 
``` 

```{r, section_exp_count_dist_3, eval="exp_count_dist" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("### Count distribution (linear)") 
``` 

```{r distributions_raw, echo=FALSE, eval="exp_count_dist" %in% section, fig.height=4.5}
STarlight::dist_st(st_grid_list) + Seurat::NoLegend()
```

```{r, section_exp_count_dist_3, eval="exp_count_dist" %in% section, echo=FALSE, results = "asis"} 
knitr::asis_output("### Count distribution (log10)") 
``` 


```{r distributions_log, echo=FALSE, eval="exp_count_dist" %in% section, fig.height=4.5}
STarlight::dist_st(st_grid_list, transform="log10") + Seurat::NoLegend()
```

## Comparisons

### todo

ezretr

